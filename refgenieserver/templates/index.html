{% extends "template.html" %}
{% block title %}Index{% endblock %}
{% block content %}
{% macro safe_show_asset_attr(x) %}
    {% if x is none or not x|length %}
        NA
    {% else %}
        {{ x }}
    {% endif %}
{% endmacro %}
{% for genome_name, assets in genomes.items() %}
<div class="row align-items-center">
    <div class="col-3" id="genome_title">
        <h4 id="genome_title" onclick="location.href='/genome/{{ genome_name }}'">{{ genome_name }} <i class="fa fa-download" aria-hidden="true"></i></h4>
    </div>
    <div class="col-9" id="asset_table">
        <table class="table table-sm" id="asset_table">
            <thead class="thead-light">
                <tr>
                    <th scope="col">asset name</th>
                    <th scope="col">asset size</th>
                    <th scope="col">archive size</th>
                    <th scope="col">archive checksum</th>
                </tr>
            </thead>
            {% for asset in assets %}
                <tbody>
                    <tr>
                        <td style="cursor:pointer" onclick="location.href='/asset/{{ genome_name }}/{{ asset }}/archive'">
                            <b>{{ asset }}</b> <i class="fa fa-download" aria-hidden="true"></i>
                        </td>
                        <td>{{ safe_show_asset_attr(rgc[genome_name][asset]["asset_size"]) }}</td>
                        <td>{{ safe_show_asset_attr(rgc[genome_name][asset]["archive_size"]) }}</td>
                        <td><code>{{ safe_show_asset_attr(rgc[genome_name][asset]["archive_checksum"]) }}</code></td>
                    </tr>
                </tbody>
            {% endfor %}
        </table>
    </div>
</div>
{% endfor %}
<hr class="featurette-divider">
<h3>What is this?</h3>
<p><i>refgenomes.org</i> is a web server where we host genome assets for several popular reference assemblies.
This server provides both a web interface and a RESTful API. Users may explore and download archived indexes from the
web interface or develop tools that programmatically query the API. Our API is built to OpenAPI 3.0 standards,
so it includes <a href="/docs">self-documenting interface</a> that will allow other tools to discover and automatically
    use the API.</p>
<p>For example, the <a href="http://refgenie.databio.org/en/latest/">refgenie CLI</a> uses the <i>refgenomes.org</i> API to query and download remote genome assets. When invoked
    with <code>refgenie pull ...</code>, the CLI uses a configurable URL to retrieve an archived tarball from the server, which it then unpacks and places in the appropriate folder location. </p>
<p>This server is a containerized, portable open-source application so that it can be independently run by others:
<p><code>docker run -p 80:80 -v refgenieserver:/app -v genomes_folder:/genomes refgenieserver -c refgnie_config.yaml serve</code></p>
{% endblock %}
